# 비동기 패턴

node.js의 큰 특징이 단일 쓰레드(싱글 쓰레드) 방식과 논 블록킹 방식.

원래는 함수는 값을 종료가 되면 값을 반환함. 하지만 논 블록킹 방식에서는 값을 반환하는 것이 아닌 함수를 반환함. 이 반환되는 함수가 *콜백함수*

비동기 방식은 메인 쓰레드가 존재하고 메인 쓰레드는 실제 코드를 실행함. 메인 쓰레드는 실행시간이 오래 걸린다고 판단하면 내부에 처리하는 다른 쓰레드로 해당 작업을 넘김. 하지만 메인 쓰레드에게 작업을 받은 쓰레드는 해당 작업이 끝나면 콜백함수를 메인 쓰레드에게 돌려줌. 메인 쓰레드는 전달받은 콜백함수를 실행함. 하지만 이 콜백함수를 실행할 때는 이미 다른 코드가 처리된 이후 임. 그리고 또 다른 작업을 쓰레드에게 전달하게됨.

node.js가 싱글 쓰레드인 이유는 실제 사용자의 요청을 받는 쓰레드가 하나라는 의미임. 클라이언트 요청을 받고 오래 걸리는 처리는 다른 
쓰레드로 넘겨 지속해서 요청을 받을 수 있는 상태를 유지함.

이렇게 논 블록킹 형태로 동작되는 방식을 비동기 방식이라고 함

non-blocking algorithm : 어떤 쓰레드가 오류가 발생하거나 멈추었을 때 다른 쓰레드에게 영향을 끼치지 않도록 만드는 방법들을 말함

이러한 특징 때문에 순서대로 실행되지 않음.

# 비동기 패턴 해결 

1. 콜백(callback) -> 콜백 헬(지옥)
2. Promise

Promise 객체에 등록한 비동기 함수가 정상적으로 실행이 완료된다면 *resolve*를 호출함. 에러가 발생되어 문제가 생겼다면 *reject*를 호출함.

Promise.all() : promise 객체로 된 것이 순서에 상관없이 실행된다면 동시에 실행시켜줄 때 사용함.

3. async/await

try ~ catch로 에러를 처리할 수 있음.

await를 이용하여 호출하는 대상은 promise 객체여야함.