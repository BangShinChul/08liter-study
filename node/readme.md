# 요청 객체, 응답 객체

### 요청 객체(request)

서버는 클라이언트의 요청사항을 해석하기 위해 요청 객체에 포함된 요청 메소드, URL, 헤더, 요청바디를 사용함.

```js
const http = require('http');

http:createServer( (req, res) => {
    console.log(req);
    res.writeHead(200);
    res.end('hello world');
}).listen(3000, () => {
   console.log('server on : 3000port') 
});
```

### 응답객체

요청 객체를 이용하여 사용자의 요청을 파악했다면, 응답 객체를 이용하여 사용자에게 원하는 형태로 응답해야 함

가장 많이 사용하는 응답코드

- 200 : 성공적으로 요청 처리
- 201 : 성공적으로 데이터를 추가함
- 404 : 요청한 리소스가 없음
- 500 : 서버의 문제로 에러 발생

사용자의 요청에 따라 처리할땐 두 가지만 기억하면 됨

- URL
- methods

URL로 어떤 메소드로 요청했는지만 파악하고 해당 요청에 맞추어 코드를 실행하여 응답하면 됨

# node js 도구들

## supervisor

코드가 바뀌면 자동으로 서버를 재시작해줌

주의할점 :  재시작되는 동안 서버가 꺼져 있는 상태이기 때문에 일시적으로 요청을 응답하지 못할 수 있음, js 파일의 변경만 감지

```
supervisor [파일명]
```

## forever

서버를 백그라운드로 실행시켜주는 도구

백그라운드에서 실행한다는 의미는 서버를 실행시킨 터미널을 종료해도 서버가 종료되지 않고 계속 실행하는 것을 의미함.

```
forever start [파일명] # 서버 백그라운드로 시작
forever stop [숫자] # 백그라운드에서 돌고있는 서버 종료
forever restart [숫자] # 백그라운드에서 돌고있는 서버 재시
```

## pm2

백그라운드로 등록해주는 도구. forever보다 많은 기능 지원

### 서버 등록(start)
```
pm2 start 이름.js
```
 
### 서버 종료(stop)


```
pm2 stop id

pm2 stop [App name] 
```

서버를 종료만 하고 프로세스는 죽이지 않음.

### 서버 정보 보기(show)

```
pm2 show id

pm2 show [App name] 
```

해당 서버의 정보를 볼 수 있음.

### 모니터링(monit)

```
pm2 monit
```

pm2로 등록된 서버들을 모니터링 할 수 있음

키보드 방향키를 통해 서버를 선택할 수 있음

Global Logs에서는 서버에서 출력되는 각종 로그를 확인할 수 있음.

### 클러스터링

클러스터링 = 분신. 서버가 하나만 떠 있는 상태에서 해당 서버가 죽으면 서비스는 동작할 수 없음. 하지만 클러스터링을 이용하면 하나의 서버를 여러 대 띄워 서버 한 쪽이 죽더라도 다른 서버가 살아있기 때문에 서비스는 유지할 수 있음.

```
pm2 start name.js -i 6
```

클러스터링하기 위해서는 -i 옵션을 주고 숫자를 입력함. 해당 서버를 몇 개를 띄울지 정해주는 숫자임. 일반적으로 CPU코어 개수만큼 넣어줌(0을 입력하면 자동으로 코어 개수에 맞춰서 띄어)

클러스터링으로 동작 중인 서버는 mode가 fork가 아니라 *cluster*로 표시함

만약 개수를 바꾸고 싶다면 scale을 이용하여 재조정할 수 있음

```
pm2 scale app 3 # App name을 넣어줌
```

# npm과 package.json

npm : Node Package Manager 노드로 생성한 패키지/프로젝트를 관리하는 도구

패키지/프로젝트 정보를 가지고 있는 것이 package.json